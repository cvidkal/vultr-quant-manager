name: Start Quant Server

on:
  schedule:
    # 09:00 EST = 14:00 UTC (EDT offset: 13:00 UTC — adjust May–Nov if needed)
    - cron: "0 14 * * 1-5"   # Mon–Fri 14:00 UTC
  workflow_dispatch:           # allow manual trigger

jobs:
  start:
    name: Create Vultr Instance
    runs-on: ubuntu-latest
    timeout-minutes: 20

    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"

      - name: Install dependencies
        run: pip install requests

      - name: Start server
        env:
          VULTR_API_KEY:          ${{ secrets.VULTR_API_KEY }}
          VULTR_SNAPSHOT_ID:      ${{ secrets.VULTR_SNAPSHOT_ID }}
          TS_AUTH_KEY:            ${{ secrets.TS_AUTH_KEY }}
          VULTR_REGION:           ${{ vars.VULTR_REGION }}       # e.g. ewr
          VULTR_PLAN:             ${{ vars.VULTR_PLAN }}         # e.g. vc2-2c-4gb
        run: python vultr_manager.py start
